# üíö Sveta Payment System

–ü–ª–∞—Ç—ñ–∂–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å–∞–π—Ç—É –Ω—É—Ç—Ä–∏—Ü—ñ–æ–ª–æ–≥–∞ –°–≤—ñ—Ç–∏ –∑ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—î—é –ÆKassa.

## üìã –©–æ –≤–∫–ª—é—á–µ–Ω–æ

- **Node.js –±–µ–∫–µ–Ω–¥** –∑ Express
- **–ÆKassa API** —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è
- **Telegram –±–æ—Ç** –¥–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –ø—Ä–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è
- **Webhook** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –ø–ª–∞—Ç–µ–∂—ñ–≤
- **–°—Ç–æ—Ä—ñ–Ω–∫–∞ —É—Å–ø—ñ—à–Ω–æ—ó –æ–ø–ª–∞—Ç–∏** –∑ –∫–æ–Ω—Ñ–µ—Ç—ñ üéâ

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –û—Ç—Ä–∏–º–∞—Ç–∏ –∫–ª—é—á—ñ –ÆKassa

1. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Å—è –Ω–∞ [yookassa.ru](https://yookassa.ru)
2. –î–æ–¥–∞–π –º–∞–≥–∞–∑–∏–Ω (–ø–æ—Ç—Ä—ñ–±–µ–Ω –Ü–ü –∞–±–æ –û–û–û)
3. –ü—Ä–æ–π–¥–∏ –º–æ–¥–µ—Ä–∞—Ü—ñ—é (1-3 –¥–Ω—ñ)
4. –í —Ä–æ–∑–¥—ñ–ª—ñ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚Üí –ö–ª—é—á–∏ API** —Å–∫–æ–ø—ñ—é–π:
   - `shopId` ‚Äî —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä –º–∞–≥–∞–∑–∏–Ω—É
   - `–°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á` ‚Äî –¥–ª—è API

### 2. –°—Ç–≤–æ—Ä–∏—Ç–∏ Telegram –±–æ—Ç–∞

1. –ù–∞–ø–∏—à–∏ [@BotFather](https://t.me/BotFather) –∫–æ–º–∞–Ω–¥—É `/newbot`
2. –î–∞–π –±–æ—Ç—É —ñ–º'—è —Ç–∞ username
3. –°–∫–æ–ø—ñ—é–π **—Ç–æ–∫–µ–Ω –±–æ—Ç–∞**
4. –ù–∞–ø–∏—à–∏ —Å–≤–æ—î–º—É –±–æ—Ç—É `/start`
5. –î—ñ–∑–Ω–∞–π—Å—è —Å–≤—ñ–π **chat_id** —á–µ—Ä–µ–∑ [@userinfobot](https://t.me/userinfobot)

### 3. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Å–µ—Ä–≤–µ—Ä

```bash
# –ü–µ—Ä–µ–π–¥–∏ –≤ –ø–∞–ø–∫—É —Å–µ—Ä–≤–µ—Ä–∞
cd server

# –í—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
npm install

# –°–∫–æ–ø—ñ—é–π –ø—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
cp ../.env.example ../.env

# –í—ñ–¥—Ä–µ–¥–∞–≥—É–π .env —Ñ–∞–π–ª
nano ../.env
```

### 4. –ó–∞–ø–æ–≤–Ω–∏—Ç–∏ .env

```env
# –ÆKassa
YOOKASSA_SHOP_ID=123456
YOOKASSA_SECRET_KEY=test_XXXXXXXXXXXXXXXX

# Telegram
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_CHAT_ID=123456789

# URLs (–∑–º—ñ–Ω–∏ –Ω–∞ —Å–≤–æ—ó)
FRONTEND_URL=https://sveta-nutrition.ru
BACKEND_URL=https://api.sveta-nutrition.ru
```

### 5. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä

```bash
# Development
npm run dev

# Production
npm start
```

### 6. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ Webhook –≤ –ÆKassa

1. –í –æ—Å–æ–±–∏—Å—Ç–æ–º—É –∫–∞–±—ñ–Ω–µ—Ç—ñ –ÆKassa –ø–µ—Ä–µ–π–¥–∏ –≤ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ‚Üí HTTP-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
2. –î–æ–¥–∞–π URL: `https://api.your-domain.ru/api/payment/webhook`
3. –í–∏–±–µ—Ä–∏ –ø–æ–¥—ñ—ó:
   - ‚úÖ payment.succeeded
   - ‚úÖ payment.canceled

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
sveta-payment/
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îú‚îÄ‚îÄ index.js          # –ì–æ–ª–æ–≤–Ω–∏–π —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ config.js         # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ payment.js    # API —Ä–æ—É—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îú‚îÄ‚îÄ yookassa.js   # –ÆKassa —Å–µ—Ä–≤—ñ—Å
‚îÇ       ‚îî‚îÄ‚îÄ telegram.js   # Telegram —Å–µ—Ä–≤—ñ—Å
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ sveta-wow.html    # –ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ success.html      # –°—Ç–æ—Ä—ñ–Ω–∫–∞ —É—Å–ø—ñ—Ö—É
‚îú‚îÄ‚îÄ .env.example          # –ü—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
‚îî‚îÄ‚îÄ README.md
```

## üîó API Endpoints

| Method | Endpoint | –û–ø–∏—Å |
|--------|----------|------|
| GET | `/` | Health check |
| GET | `/api/payment/programs` | –°–ø–∏—Å–æ–∫ –ø—Ä–æ–≥—Ä–∞–º |
| POST | `/api/payment/create` | –°—Ç–≤–æ—Ä–∏—Ç–∏ –ø–ª–∞—Ç—ñ–∂ |
| GET | `/api/payment/status/:id` | –°—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂—É |
| POST | `/api/payment/webhook` | Webhook –ÆKassa |

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–ª–∞—Ç–µ–∂—É

```bash
curl -X POST http://localhost:3000/api/payment/create \
  -H "Content-Type: application/json" \
  -d '{
    "program": "marafon",
    "name": "–ê–Ω–Ω–∞",
    "email": "anna@example.com",
    "phone": "+79001234567",
    "telegram": "@anna"
  }'
```

## üåê –î–µ–ø–ª–æ–π

### –í–∞—Ä—ñ–∞–Ω—Ç 1: VPS (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

1. –û—Ä–µ–Ω–¥—É–π VPS (Timeweb, Beget, DigitalOcean)
2. –í—Å—Ç–∞–Ω–æ–≤–∏ Node.js 18+
3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π PM2 –¥–ª—è –∑–∞–ø—É—Å–∫—É:

```bash
npm install -g pm2
pm2 start index.js --name sveta-payment
pm2 save
pm2 startup
```

4. –ù–∞–ª–∞—à—Ç—É–π Nginx —è–∫ reverse proxy

### –í–∞—Ä—ñ–∞–Ω—Ç 2: Railway / Render

1. –ü—ñ–¥–∫–ª—é—á–∏ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
2. –î–æ–¥–∞–π environment variables
3. Deploy!

## üí∞ –ö–æ–º—ñ—Å—ñ—è –ÆKassa

- –ë–∞–Ω–∫—ñ–≤—Å—å–∫—ñ –∫–∞—Ä—Ç–∏: **3.5%**
- SberPay: **2.8%**
- –ÆMoney: **3%**

## üîí –ë–µ–∑–ø–µ–∫–∞

- –°–µ–∫—Ä–µ—Ç–Ω—ñ –∫–ª—é—á—ñ —Ç—ñ–ª—å–∫–∏ –≤ `.env` (–Ω–µ –∫–æ–º—ñ—Ç—å!)
- HTTPS –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –¥–ª—è webhook
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Å—ñ—Ö –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö
- CORS –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π —Ç—ñ–ª—å–∫–∏ –¥–ª—è —Ç–≤–æ–≥–æ –¥–æ–º–µ–Ω—É

## ‚ùì FAQ

**Q: –ß–∏ –ø–æ—Ç—Ä—ñ–±–µ–Ω –Ü–ü –¥–ª—è –ÆKassa?**
A: –¢–∞–∫, –¥–ª—è –ø—Ä–∏–π–æ–º—É –ø–ª–∞—Ç–µ–∂—ñ–≤ –ø–æ—Ç—Ä—ñ–±–µ–Ω –Ü–ü –∞–±–æ –û–û–û.

**Q: –°–∫—ñ–ª—å–∫–∏ —á–∞—Å—É –∑–∞–π–º–∞—î –º–æ–¥–µ—Ä–∞—Ü—ñ—è?**
A: –ó–∞–∑–≤–∏—á–∞–π 1-3 —Ä–æ–±–æ—á–∏—Ö –¥–Ω—ñ.

**Q: –ß–∏ –º–æ–∂–Ω–∞ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –±–µ–∑ —Ä–µ–∞–ª—å–Ω–∏—Ö –≥—Ä–æ—à–µ–π?**
A: –¢–∞–∫! –ÆKassa –º–∞—î —Ç–µ—Å—Ç–æ–≤–∏–π —Ä–µ–∂–∏–º –∑ —Ç–µ—Å—Ç–æ–≤–∏–º–∏ –∫–∞—Ä—Ç–∫–∞–º–∏.

## üìû –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–Ø–∫—â–æ —î –ø–∏—Ç–∞–Ω–Ω—è ‚Äî –ø–∏—à–∏ –≤ Telegram!

---

Made with üíö for Sveta Nutritionist
